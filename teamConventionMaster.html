<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íŒ€ ì»¨ë²¤ì…˜ ë§ˆìŠ¤í„° (AI ê¸°ë°˜ ë¶„ë¦¬ ìƒì„±)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap");
      body {
        font-family:
          "Pretendard",
          -apple-system,
          sans-serif;
        background-color: #f8fafc;
      }
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }

      /* ë§ˆí¬ë‹¤ìš´ ë¦¬í¬íŠ¸ ìŠ¤íƒ€ì¼ë§ */
      .md-content h1 {
        font-size: 1.5rem;
        font-weight: 800;
        margin-bottom: 1rem;
        color: #1e293b;
        border-bottom: 3px solid #6366f1;
        display: inline-block;
      }
      .md-content h2 {
        font-size: 1.25rem;
        font-weight: 700;
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
        color: #1e293b;
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 0.2rem;
      }
      .md-content h3 {
        font-size: 1.1rem;
        font-weight: 700;
        margin-top: 1.25rem;
        margin-bottom: 0.5rem;
        color: #475569;
      }
      .md-content h3::before {
        content: "â€¢";
        color: #6366f1;
        margin-right: 0.5rem;
      }
      .md-content p {
        margin-bottom: 0.75rem;
        color: #475569;
        font-size: 0.95rem;
        line-height: 1.7;
      }
      .md-content ul {
        margin-bottom: 1rem;
        padding-left: 1.25rem;
      }
      .md-content li {
        margin-bottom: 0.4rem;
        color: #475569;
        font-size: 0.9rem;
        list-style-type: disc;
      }
      .md-content strong {
        color: #1e293b;
        font-weight: 600;
      }
      .md-content code {
        background-color: #f1f5f9;
        color: #6366f1;
        padding: 0.1rem 0.3rem;
        border-radius: 0.25rem;
        font-family: monospace;
        font-size: 0.85rem;
      }
      .md-content blockquote {
        border-left: 4px solid #cbd5e1;
        padding-left: 1rem;
        margin: 1rem 0;
        color: #64748b;
        font-style: italic;
      }

      .loading-dots:after {
        content: ".";
        animation: dots 1.5s steps(5, end) infinite;
      }
      @keyframes dots {
        0%,
        20% {
          content: ".";
        }
        40% {
          content: "..";
        }
        60% {
          content: "...";
        }
        80%,
        100% {
          content: "";
        }
      }

      .tab-active {
        border-bottom: 2px solid #6366f1;
        color: #6366f1;
      }

      /* ì„ íƒê¸° ìŠ¤íƒ€ì¼ */
      .select-btn {
        transition: all 0.2s;
      }
      .select-btn.active {
        background-color: #6366f1;
        color: white;
        border-color: #6366f1;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      }
      .select-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      /* ì ê¸ˆ ìƒíƒœ ìŠ¤íƒ€ì¼ */
      input:disabled,
      button:disabled:not(.select-btn) {
        cursor: not-allowed;
      }
      .locked-bg {
        background-color: #f1f5f9 !important;
        color: #94a3b8 !important;
      }
    </style>
  </head>
  <body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
      <!-- í—¤ë” -->
      <header class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-slate-800 mb-2">
          Team Convention Master
        </h1>
        <p class="text-slate-500 font-medium text-indigo-600 italic">
          "ì–¸ì–´ì™€ IDEì— ë§ëŠ” ìë™ ì„¤ì • íŒŒì¼"ê³¼ "ê³µìœ ìš© ê°€ì´ë“œ"ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
        </p>
      </header>

      <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
        <!-- ì™¼ìª½: ì…ë ¥ ì„¹ì…˜ (40%) -->
        <section class="lg:col-span-5">
          <!-- ì–¸ì–´ ë° IDE ì„ íƒ -->
          <div
            class="bg-white border border-slate-200 rounded-xl p-5 mb-6 shadow-sm space-y-5"
          >
            <div>
              <h3
                class="text-sm font-bold text-slate-700 mb-3 flex items-center gap-2"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 text-indigo-500"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
                  />
                </svg>
                1. ê°œë°œ ì–¸ì–´ ì„ íƒ
              </h3>
              <div class="flex gap-2" id="lang-selector">
                <button
                  onclick="setLanguage('Java')"
                  id="lang-Java"
                  class="select-btn active flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  Java
                </button>
                <button
                  onclick="setLanguage('JavaScript')"
                  id="lang-JavaScript"
                  class="select-btn flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  JavaScript
                </button>
                <button
                  onclick="setLanguage('Kotlin')"
                  id="lang-Kotlin"
                  class="select-btn flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  Kotlin
                </button>
              </div>
            </div>

            <div>
              <h3
                class="text-sm font-bold text-slate-700 mb-3 flex items-center gap-2"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 text-indigo-500"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                  />
                </svg>
                2. ëŒ€ìƒ IDE ì„ íƒ
              </h3>
              <div class="flex gap-2" id="ide-selector">
                <button
                  onclick="setIDE('IntelliJ')"
                  id="ide-IntelliJ"
                  class="select-btn active flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  IntelliJ
                </button>
                <button
                  onclick="setIDE('VS Code')"
                  id="ide-VSCode"
                  class="select-btn flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  VS Code
                </button>
                <button
                  onclick="setIDE('Android Studio')"
                  id="ide-AndroidStudio"
                  class="select-btn flex-1 py-2 px-3 text-xs font-bold border border-slate-200 rounded-lg hover:bg-slate-50"
                >
                  Android Studio
                </button>
              </div>
            </div>
          </div>

          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold text-slate-700">
              ì»¨ë²¤ì…˜ ê·œì¹™ ì…ë ¥
            </h2>
            <button
              id="add-topic-btn"
              onclick="addTopic()"
              class="bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              + ì£¼ì œ ì¶”ê°€
            </button>
          </div>

          <div id="topics-container" class="space-y-4 mb-6">
            <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
          </div>

          <div class="space-y-2">
            <button
              id="ai-btn"
              onclick="generateWithAI()"
              class="w-full bg-slate-800 hover:bg-slate-900 text-white py-4 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-3 transition transform active:scale-95 disabled:opacity-70"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-indigo-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"
                />
              </svg>
              ì „ë¬¸í™”ëœ ê²°ê³¼ ìƒì„±í•˜ê¸°
            </button>
            <!-- ë¶„ì„ ì·¨ì†Œ ë²„íŠ¼ -->
            <button
              id="cancel-btn"
              onclick="cancelAI()"
              class="hidden w-full bg-red-100 hover:bg-red-200 text-red-600 py-2 rounded-xl font-bold text-sm transition transform active:scale-95 flex items-center justify-center gap-2"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
              ë¶„ì„ ì¤‘ë‹¨
            </button>
          </div>
        </section>

        <!-- ì˜¤ë¥¸ìª½: ê²°ê³¼ ì„¹ì…˜ (60%) -->
        <section class="lg:col-span-7 space-y-6">
          <div
            class="bg-white border border-slate-200 rounded-2xl shadow-xl overflow-hidden flex flex-col h-[750px]"
          >
            <!-- ìƒë‹¨ íƒ­ -->
            <div class="flex border-b border-slate-200 bg-slate-50">
              <button
                onclick="switchTab('code')"
                id="tab-code"
                class="flex-1 py-4 text-sm font-bold transition tab-active"
              >
                ğŸ’» IDE ì„¤ì • (XML)
              </button>
              <button
                onclick="switchTab('markdown')"
                id="tab-markdown"
                class="flex-1 py-4 text-sm font-bold text-slate-400 transition"
              >
                ğŸ“„ íŒ€ ê°€ì´ë“œ (MD)
              </button>
              <button
                onclick="switchTab('analysis')"
                id="tab-analysis"
                class="flex-1 py-4 text-sm font-bold text-slate-400 transition"
              >
                ğŸ” AI ë¶„ì„ ë¦¬í¬íŠ¸
              </button>
            </div>

            <!-- ë‚´ìš© ì˜ì—­ -->
            <div class="flex-1 overflow-hidden relative">
              <!-- Code Preview (XML or JSON) -->
              <div
                id="content-code"
                class="absolute inset-0 p-6 bg-slate-900 overflow-auto custom-scrollbar"
              >
                <div class="flex justify-between items-center mb-4">
                  <div class="flex flex-col">
                    <span
                      class="text-slate-500 font-mono text-xs"
                      id="file-label-code"
                      >config_file</span
                    >
                    <div class="flex gap-2 items-center mt-1">
                      <span
                        id="target-summary-label"
                        class="text-[10px] text-indigo-400 font-bold uppercase tracking-wider"
                        >Java | IntelliJ</span
                      >
                    </div>
                  </div>
                  <button
                    onclick="downloadFile('code')"
                    class="text-xs bg-emerald-500 text-white px-2 py-1 rounded hover:bg-emerald-600 transition"
                  >
                    ë‹¤ìš´ë¡œë“œ
                  </button>
                </div>
                <pre
                  id="code-preview"
                  class="text-indigo-300 font-mono text-sm leading-relaxed whitespace-pre-wrap"
                ></pre>
              </div>

              <!-- Markdown Preview -->
              <div
                id="content-markdown"
                class="absolute inset-0 p-8 bg-white overflow-auto custom-scrollbar hidden"
              >
                <div
                  class="flex justify-between items-center mb-6 border-b pb-2"
                >
                  <span class="text-slate-400 text-xs">TEAM_CONVENTION.md</span>
                  <button
                    onclick="downloadFile('md')"
                    class="text-xs bg-indigo-500 text-white px-2 py-1 rounded hover:bg-indigo-600 transition"
                  >
                    ë‹¤ìš´ë¡œë“œ
                  </button>
                </div>
                <div id="markdown-preview" class="md-content"></div>
              </div>

              <!-- Analysis Preview -->
              <div
                id="content-analysis"
                class="absolute inset-0 p-8 bg-slate-50 overflow-auto custom-scrollbar hidden"
              >
                <div id="analysis-preview" class="md-content"></div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <script>
      const apiKey = "";
      let selectedLanguage = "Java";
      let selectedIDE = "IntelliJ";
      let abortController = null;
      let isLocked = false;

      let state = [
        {
          id: 1,
          title: "ì»¤ë°‹ ì»¨ë²¤ì…˜",
          rules: ["ë¨¸ë¦¬ë§ [Feat], [Fix] ì‚¬ìš©", "ì œëª©ì€ í•œê¸€ë¡œ ê°„ê²°í•˜ê²Œ ì‘ì„±"],
        },
        {
          id: 2,
          title: "ê¸°ë³¸ í¬ë§·íŒ…",
          rules: ["ë“¤ì—¬ì“°ê¸° ìŠ¤í˜ì´ìŠ¤ 4ì¹¸", "ì¤„ ë„ˆë¹„ ìµœëŒ€ 120ì"],
        },
      ];

      let results = { code: "", markdown: "", analysis: "" };
      let activeTab = "code";

      function render() {
        const container = document.getElementById("topics-container");
        container.innerHTML = "";

        document.getElementById("add-topic-btn").disabled = isLocked;
        document
          .querySelectorAll(".select-btn")
          .forEach((btn) => (btn.disabled = isLocked));

        state.forEach((topic) => {
          const card = document.createElement("div");
          card.className = `bg-white border border-slate-200 rounded-xl p-4 shadow-sm ${isLocked ? "opacity-90" : ""}`;
          card.innerHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <input type="text" value="${topic.title}" 
                               ${isLocked ? "disabled" : ""}
                               onchange="updateTopicTitle(${topic.id}, this.value)" 
                               class="font-bold text-slate-800 outline-none w-full bg-transparent border-b border-transparent focus:border-indigo-300 ${isLocked ? "locked-bg" : ""}">
                        ${!isLocked ? `<button onclick="removeTopic(${topic.id})" class="text-slate-300 hover:text-red-500">âœ•</button>` : ""}
                    </div>
                    <div class="space-y-2 mb-2">
                        ${topic.rules
                          .map(
                            (r, i) => `
                            <div class="flex gap-2">
                                <input type="text" value="${r}" 
                                       ${isLocked ? "disabled" : ""}
                                       onchange="updateRule(${topic.id}, ${i}, this.value)" 
                                       class="flex-1 text-sm border rounded p-2 outline-none focus:ring-1 focus:ring-indigo-300 ${isLocked ? "locked-bg" : "bg-slate-50"}">
                                ${!isLocked ? `<button onclick="removeRule(${topic.id}, ${i})" class="text-slate-300 hover:text-red-400">âœ•</button>` : ""}
                            </div>
                        `,
                          )
                          .join("")}
                    </div>
                    ${!isLocked ? `<button onclick="addRule(${topic.id})" class="text-[10px] font-bold text-indigo-500 hover:underline">+ ê·œì¹™ ì¶”ê°€</button>` : ""}
                `;
          container.appendChild(card);
        });
        updateLabels();
      }

      function setLanguage(lang) {
        if (isLocked) return;
        selectedLanguage = lang;
        document
          .querySelectorAll('[id^="lang-"]')
          .forEach((btn) => btn.classList.remove("active"));
        document
          .getElementById(`lang-${lang.replace(" ", "")}`)
          .classList.add("active");
        updateLabels();
        updateInitialPreview();
      }

      function setIDE(ide) {
        if (isLocked) return;
        selectedIDE = ide;
        document
          .querySelectorAll('[id^="ide-"]')
          .forEach((btn) => btn.classList.remove("active"));
        document
          .getElementById(`ide-${ide.replace(" ", "")}`)
          .classList.add("active");
        updateLabels();
        updateInitialPreview();
      }

      function updateLabels() {
        const summary = `${selectedLanguage} | ${selectedIDE}`;
        document.getElementById("target-summary-label").textContent = summary;

        const isVSCode = selectedIDE === "VS Code";
        document.getElementById("tab-code").textContent = isVSCode
          ? "ğŸ’» ì„¤ì • (JSON)"
          : "ğŸ’» ì„¤ì • (XML)";
        document.getElementById("file-label-code").textContent = isVSCode
          ? "settings.json"
          : "codeStyleConfig.xml";
      }

      function switchTab(tab) {
        ["code", "markdown", "analysis"].forEach((t) => {
          document
            .getElementById(`tab-${t}`)
            .classList.remove("tab-active", "text-slate-800");
          document.getElementById(`tab-${t}`).classList.add("text-slate-400");
          document.getElementById(`content-${t}`).classList.add("hidden");
        });
        document
          .getElementById(`tab-${tab}`)
          .classList.add("tab-active", "text-slate-800");
        document.getElementById(`content-${tab}`).classList.remove("hidden");
        activeTab = tab;
      }

      function addTopic() {
        if (isLocked) return;
        state.push({ id: Date.now(), title: "ìƒˆ ì£¼ì œ", rules: [""] });
        render();
      }
      function removeTopic(id) {
        if (isLocked) return;
        state = state.filter((t) => t.id !== id);
        render();
      }
      function updateTopicTitle(id, val) {
        if (isLocked) return;
        state.find((t) => t.id === id).title = val;
        updateInitialPreview();
      }
      function addRule(id) {
        if (isLocked) return;
        state.find((t) => t.id === id).rules.push("");
        render();
      }
      function updateRule(tid, idx, val) {
        if (isLocked) return;
        state.find((t) => t.id === tid).rules[idx] = val;
        updateInitialPreview();
      }
      function removeRule(tid, idx) {
        if (isLocked) return;
        const t = state.find((t) => t.id === tid);
        t.rules.splice(idx, 1);
        if (t.rules.length === 0) t.rules.push("");
        render();
      }

      function updateInitialPreview() {
        const format = selectedIDE === "VS Code" ? "JSON" : "XML";
        document.getElementById("code-preview").textContent =
          `<!-- ${selectedLanguage} ë° ${selectedIDE}ì— ìµœì í™”ëœ ${format} ì„¤ì •ì„ ìƒì„±í•˜ë ¤ë©´ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš” -->`;
        document.getElementById("markdown-preview").innerHTML =
          `<p class='text-slate-400'>ì—¬ê¸°ì— ê³µì‹ íŒ€ ê°€ì´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤.</p>`;
      }

      function parseMarkdown(text) {
        if (!text) return "";
        return text
          .replace(/^# (.*$)/gim, "<h1>$1</h1>")
          .replace(/^## (.*$)/gim, "<h2>$1</h2>")
          .replace(/^### (.*$)/gim, "<h3>$1</h3>")
          .replace(/^> (.*$)/gim, "<blockquote>$1</blockquote>")
          .replace(/\*\*(.*)\*\*/gim, "<strong>$1</strong>")
          .replace(/`(.*?)`/gim, "<code>$1</code>")
          .replace(/^\- (.*$)/gim, "<li>$1</li>")
          .replace(/^\* (.*$)/gim, "<li>$1</li>")
          .replace(/\n\n/g, "</p><p>")
          .replace(/\n/g, "<br>")
          .replace(/(<li>.*<\/li>)/gim, "<ul>$1</ul>")
          .replace(/<\/ul><ul>/gim, "");
      }

      function cancelAI() {
        if (abortController) {
          abortController.abort();
          const btn = document.getElementById("ai-btn");
          const cancelBtn = document.getElementById("cancel-btn");
          btn.disabled = false;
          btn.innerHTML = `ìƒì„± ì¤‘ë‹¨ë¨ (ë‹¤ì‹œ ì‹œë„)`;
          cancelBtn.classList.add("hidden");
          isLocked = false;
          render();
        }
      }

      async function generateWithAI() {
        const btn = document.getElementById("ai-btn");
        const cancelBtn = document.getElementById("cancel-btn");

        // í¸ì§‘ ì ê¸ˆ ì‹œì‘
        isLocked = true;
        render();

        btn.disabled = true;
        btn.innerHTML = `<span class="loading-dots">AIê°€ ${selectedIDE}ìš© ì„¤ì • ìƒì„± ì¤‘</span>`;
        cancelBtn.classList.remove("hidden");

        abortController = new AbortController();

        const userContent = state
          .map((t) => `[ì£¼ì œ: ${t.title}]\n${t.rules.join("\n")}`)
          .join("\n\n");
        const systemPrompt = `ë‹¹ì‹ ì€ ê°œë°œ íŒ€ ì»¨ë²¤ì…˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. 
            ì–¸ì–´: **${selectedLanguage}**, IDE: **${selectedIDE}**
            
            ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë§ì¶° JSON ì‘ë‹µì„ ì œê³µí•˜ì„¸ìš”:
            { "code": "CONFIG_CODE", "markdown": "GUIDE_MD", "analysis": "REPORT_AN" }

            ì¤‘ìš” ì§€ì¹¨:
            1. "code" í•„ë“œ: **${selectedIDE}**ì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì • ì½”ë“œë¥¼ ë‹´ìœ¼ì„¸ìš”. 
               - VS Codeë¼ë©´ ë°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ì˜ settings.json ë‚´ìš©ì„ ë¬¸ìì—´ë¡œ ë‹´ìœ¼ì„¸ìš”. (ê°ì²´ í˜•íƒœê°€ ì•„ë‹Œ ë¬¸ìì—´ë¡œ ë°˜í™˜)
               - IntelliJ/Android Studioë¼ë©´ XML ë‚´ìš©ì„ ë‹´ìœ¼ì„¸ìš”.
            2. "markdown" í•„ë“œ: ì…ë ¥ëœ ëª¨ë“  ê·œì¹™ì„ í¬í•¨í•œ ê°œë°œ íŒ€ ê°€ì´ë“œ ë§ˆí¬ë‹¤ìš´.
            3. "analysis" í•„ë“œ: ì ìš© ë°©ë²• ë° ì£¼ì˜ì  ë¦¬í¬íŠ¸.
            4. ëª¨ë“  í…ìŠ¤íŠ¸ëŠ” í•œêµ­ì–´ë¡œ ë‹µë³€í•˜ì„¸ìš”.`;

        try {
          const response = await fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                contents: [{ parts: [{ text: userContent }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: { responseMimeType: "application/json" },
              }),
              signal: abortController.signal,
            },
          );

          const data = await response.json();
          const rawResults = JSON.parse(
            data.candidates?.[0]?.content?.parts?.[0]?.text,
          );

          // VS Code ì„¤ì •ì´ ê°ì²´ë¡œ ë“¤ì–´ì˜¨ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ ì•ˆì „í•˜ê²Œ ë¬¸ìì—´í™”
          if (typeof rawResults.code === "object") {
            results.code = JSON.stringify(rawResults.code, null, 2);
          } else {
            results.code = rawResults.code;
          }

          results.markdown = rawResults.markdown;
          results.analysis = rawResults.analysis;

          document.getElementById("code-preview").textContent = results.code;
          document.getElementById("markdown-preview").innerHTML = parseMarkdown(
            results.markdown,
          );
          document.getElementById("analysis-preview").innerHTML = parseMarkdown(
            results.analysis,
          );

          btn.disabled = false;
          btn.innerHTML = `ì „ë¬¸í™”ëœ ê²°ê³¼ ìƒì„±í•˜ê¸°`;
          cancelBtn.classList.add("hidden");

          switchTab("markdown");
        } catch (error) {
          if (error.name === "AbortError") {
            console.log("ì¤‘ë‹¨ë¨");
          } else {
            console.error(error);
            btn.disabled = false;
            btn.textContent = "ìƒì„± ì˜¤ë¥˜ ë°œìƒ";
            cancelBtn.classList.add("hidden");
          }
        } finally {
          // í¸ì§‘ ì ê¸ˆ í•´ì œ
          isLocked = false;
          render();
        }
      }

      function downloadFile(type) {
        const content = type === "code" ? results.code : results.markdown;
        if (!content) return;
        const isVSCode = selectedIDE === "VS Code";
        const filename =
          type === "code"
            ? isVSCode
              ? "settings.json"
              : "code-style.xml"
            : "TEAM_CONVENTION.md";
        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        a.click();
      }

      render();
    </script>
  </body>
</html>
